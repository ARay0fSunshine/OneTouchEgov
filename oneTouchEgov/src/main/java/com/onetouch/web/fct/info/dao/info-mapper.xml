<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.onetouch.web.fct.info.dao.InfoMapper">
<!-- 작성자 : 박종현 -->

<!-- 현재 날자 값 조회 -->
<select id="todayDate" resultType="com.onetouch.web.fct.info.dao.InfoVO">
	SELECT (sysdate-7) as fixFrom, sysdate fixTo   FROM dual
</select>

<!-- 라인 조회-->
<select id="LineSelect" resultType="com.onetouch.web.fct.info.dao.LineVO">
	SELECT * from fct_line 
	<if test='fctLineChek =="Y"'>
		WHERE use_yn = 'Y'
	</if>
</select>
<!-- 라인 등록 -->
<insert id="LineInsert">
	insert into fct_line values(#{lineNO},#{totPdtAmt},#{uphPdtAmt},
	<if test = "useYn ==null or useYn==''">
      'N'	
   </if>
   <if test = 'useYn =="Y"'>
      'Y'
   </if>
   ,#{empNo})
</insert>
<update id="LineUpdate">
	UPDATE fct_line SET TOT_PDT_AMT = #{totPdtAmt}, UPH_PDT_AMT = #{uphPdtAmt}, USE_YN = #{useYn}, EMP_NO = #{empNo} WHERE LINE_NO = #{lineNO}
</update>
<delete id="LineDelete">
	DELETE fct_line where line_no = #{lineNO}
</delete>


<!-- 공정관리VO를 상속받는 설비VO를 리절트 타입으로  -->
<select id="selectprcCd" resultType="com.onetouch.web.fct.info.dao.InfoVO">
select * from fct_info where line_no = #{lineNo}
</select>

<!-- 등록 목록조회 -->
<select id="selectFctInfoAll" resultType="com.onetouch.web.fct.info.dao.InfoVO">
	select f.*, a.prc_nm as  prcNm
	from fct_info f join adm_prc_mng a 
	    on f.prc_cd = a.prc_cd
	where 1=1
		<if test='checkPrcCd != "d" and checkPrcCd != null'>
			and  substr(f.fct_cd,1,11) = #{checkPrcCd}
		</if>
		<if test="fixTo != null">
			<![CDATA[
				AND f.in_date <= #{fixTo}
			]]>
		</if>
		<if test="fixFrom != null">
			<![CDATA[
				AND f.in_date >= #{fixFrom}
			]]>
		</if>
</select>

<!-- 설비코드 조회 -->
<select id="selectCheckFct" resultType="com.onetouch.web.fct.info.dao.InfoVO">
	SELECT fct_cd,fct_nm FROM fct_info
</select>
<!-- 단건조회 -->
<select id="selectFctInfo" resultType="com.onetouch.web.fct.info.dao.InfoVO">
	select * from fct_Info where fct_cd = #{fct_cd}
</select>
<!-- 등록 -->
<insert id="insertFctInfo">
	Insert into FCT_INFO (   FCT_CD
                             ,FCT_NM
                             ,LINE_NO
							 ,PRC_CD
							 ,FCT_STD
							 ,FCT_MODEL
							 ,COMP_CD
							 ,IN_DATE
							 ,PURCH_COST
							 ,CHK_PROD
                             ,CHK_PROD_UNIT
							 ,FCT_IMG
							 ,UPLOAD_PATH
							 ) 
	values (#{fctCd},#{fctNm},#{lineNO},#{prcCd},#{fctStd},#{fctModel},#{compCd},#{inDate},#{purchCost},#{chkProd},#{chkProdUnit},#{fctImg},#{uploadPath})
</insert>
<!-- 수정 -->
<update id="InfoUpdate">
	update fct_info set 
					 FCT_NM= #{fctNm}
					,PRC_CD= #{prcCd}
					,FCT_STD= #{fctStd}
					,FCT_MODEL= #{fctModel}
					,IN_DATE= #{inDate}
					,PURCH_COST= #{purchCost}
					,CHK_PROD= #{chkProd}
                    ,CHK_PROD_UNIT = #{chkProdUnit}
					,FCT_IMG= #{fctImg}
					,UPLOAD_PATH= #{uploadPath}
	where fct_cd= #{fctCd}
</update>
<!-- 삭제 -->
<delete id="deleteFctInfo">
	delete fct_info where fct_cd in <foreach collection="list" item="lists" open="(" close=")" separator=",">#{lists.fctCd}</foreach> 
</delete>	
</mapper>

